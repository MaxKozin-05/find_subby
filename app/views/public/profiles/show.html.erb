<!-- app/views/public/profiles/show.html.erb (updated) -->
<div class="mx-auto max-w-6xl p-6">
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    <!-- Main content -->
    <div class="lg:col-span-2">
      <!-- Header -->
      <header class="flex items-center gap-4">
        <% if @profile.logo.attached? %>
          <%= image_tag @profile.logo.variant(resize_to_limit: [160, 160]), class: 'h-16 w-16 object-cover rounded-full border' %>
        <% else %>
          <div class="h-16 w-16 rounded-full border bg-gray-100"></div>
        <% end %>
        <div>
          <h1 class="text-3xl font-semibold"><%= @profile.business_name %></h1>
          <p class="text-gray-600">
            <%= @profile.trade_type.presence || "Trade" %>
            <% if @profile.service_areas.any? %> â€¢ <%= @profile.service_areas.join(', ') %><% end %>
          </p>
        </div>
      </header>

      <!-- About -->
      <% if @profile.about.present? %>
        <section class="mt-6 prose max-w-none">
          <%= simple_format(@profile.about) %>
        </section>
      <% end %>

      <!-- Projects -->
      <section class="mt-8">
        <h2 class="text-xl font-semibold mb-3">Projects</h2>
        <% if @projects.any? %>
          <div class="grid gap-4 md:grid-cols-2">
            <% @projects.each do |project| %>
              <div class="rounded-xl overflow-hidden border bg-white">
                <% if project.photos.attached? %>
                  <%= image_tag project.photos.first.variant(resize_to_fill: [600, 400]), class: 'w-full h-40 object-cover' %>
                <% else %>
                  <div class="w-full h-40 bg-gray-100 flex items-center justify-center text-gray-400 text-sm">No photo</div>
                <% end %>
                <div class="p-4">
                  <h3 class="font-medium"><%= project.title %></h3>
                  <p class="text-sm text-gray-600 line-clamp-3"><%= project.description %></p>
                </div>
              </div>
            <% end %>
          </div>
        <% else %>
          <div class="rounded-xl border bg-white p-6 text-center text-gray-600">
            No projects published yet.
          </div>
        <% end %>
      </section>
    </div>

    <!-- Sidebar -->
    <div class="lg:col-span-1">
      <!-- Compact Calendar -->
      <%= render 'shared/compact_calendar',
          profile: @profile,
          current_month: @current_month,
          calendar_data: @calendar_data %>
    </div>
  </div>

  <!-- Job Request Form -->
  <section class="mt-12">
    <div class="bg-white rounded-lg shadow p-6">
      <h2 class="text-xl font-semibold mb-4">Request a Quote</h2>

      <%= form_with model: Job.new, url: public_profile_jobs_path(@profile.handle),
          local: true, html: { class: 'space-y-4', 'data-turbo': 'false' } do |f| %>

        <div class="grid gap-4 md:grid-cols-2">
          <div>
            <%= f.label :client_name, "Your Name", class: "block text-sm font-medium mb-2" %>
            <%= f.text_field :client_name, class: "w-full p-3 border rounded-lg", required: true %>
          </div>

          <div>
            <%= f.label :client_email, "Email", class: "block text-sm font-medium mb-2" %>
            <%= f.email_field :client_email, class: "w-full p-3 border rounded-lg", required: true %>
          </div>
        </div>

        <div class="grid gap-4 md:grid-cols-2">
          <div>
            <%= f.label :client_phone, "Phone (optional)", class: "block text-sm font-medium mb-2" %>
            <%= f.number_field  :client_phone, class: "w-full p-3 border rounded-lg" %>
          </div>

          <div>
            <%= f.label :estimated_budget, "Estimated Budget ($)", class: "block text-sm font-medium mb-2" %>
            <%= f.number_field :estimated_budget, step: 0.01, class: "w-full p-3 border rounded-lg" %>
          </div>
        </div>

        <div>
          <%= f.label :title, "Project Title", class: "block text-sm font-medium mb-2" %>
          <%= f.text_field :title, class: "w-full p-3 border rounded-lg",
              placeholder: "e.g., Kitchen renovation, Bathroom tiling", required: true %>
        </div>

        <div>
          <%= f.label :description, "Project Description", class: "block text-sm font-medium mb-2" %>
          <%= f.text_area :description, rows: 4, class: "w-full p-3 border rounded-lg",
              placeholder: "Please describe your project in detail..." %>
        </div>

        <div class="grid gap-4 md:grid-cols-2">
          <div>
            <%= f.label :location, "Location", class: "block text-sm font-medium mb-2" %>
            <%= f.text_field :location, class: "w-full p-3 border rounded-lg",
                placeholder: "Project address or suburb" %>
          </div>

          <div>
            <%= f.label :preferred_start_date, "Preferred Start Date", class: "block text-sm font-medium mb-2" %>
            <%= f.date_field :preferred_start_date, class: "w-full p-3 border rounded-lg" %>
          </div>
        </div>

        <%= f.submit "Request Quote",
            class: "w-full bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 font-medium" %>
      <% end %>
    </div>
  </section>
</div>
